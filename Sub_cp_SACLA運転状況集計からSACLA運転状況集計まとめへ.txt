Sub cp_SACLA運転状況集計からSACLA運転状況集計まとめへ()
   
   Dim wb As Workbook
   Dim BL As Integer  ' 対象BL
    'BL = 3
    BL = InputBox("BLを入力してください")
    
    Select Case BL
        Case 1
            Debug.Print "SCSS+"
        Case 2
            Debug.Print "BL2"
            BNAME_SHUKEI = "\\saclaopr18.spring8.or.jp\common\運転状況集計\最新\SACLA\SACLA運転状況集計BL2.xlsm"
            SNAME_KEIKAKU_BL = "bl2"
        Case 3
            Debug.Print ">>>BL3"
            BNAME_SHUKEI = "\\saclaopr18.spring8.or.jp\common\運転状況集計\最新\SACLA\SACLA運転状況集計BL3.xlsm"
            SNAME_KEIKAKU_BL = "bl3"
        Case Else
            Debug.Print "Zzz..."
            End
    End Select
    
    
    

    
    
' MOTO           Set wb1 = Workbooks.Open(BNAME_SHUKEI, ReadOnly:=False)
             ' BNAME_SHUKEIを開く
            Dim wb1 As Workbook '　ちゃんと宣言しないと、関数SheetExistsの引数が異なると怒られる
            For Each wb In Workbooks ' 開いているブックの中に指定されたパスのブックがあるかを確認
                If wb.FullName = BNAME_SHUKEI Then
                    Set wb1 = wb
                    Exit For
                End If
            Next wb
            If wb1 Is Nothing Then ' wb1 が Nothing の場合、ブックは開かれていないので新たに開く
                Set wb1 = Workbooks.Open(BNAME_SHUKEI, ReadOnly:=False)
            End If
            Debug.Print "Debug   wb1.Name =  " & wb1.Name & "を開きました"
            
            
            
            If InStr(ActiveWorkbook.Name, BNAME_SHUKEI) Then
                MsgBox "現在アクティブなブック名が異常です。終了します。" & vbCrLf & "ActiveWorkbook.Name:  " & ActiveWorkbook.Name & vbCrLf & "BNAME_SHUKEI:  " & BNAME_SHUKEI, Buttons:=vbCritical
                End
            End If
    
    
    
    
    
    
    

End Sub
